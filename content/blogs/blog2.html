---
title: "Magna"
date: "2017-10-31T22:26:09-05:00"
description: Lorem Etiam Nullam
draft: no
image: pic09.jpg
keywords: ''
slug: magna
categories:
- ''
- ''
---



<div id="rents-in-san-francsisco-2000-2018" class="section level1">
<h1>Rents in San Francsisco 2000-2018</h1>
<pre class="r"><code># download directly off tidytuesdaygithub repo

rent &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-07-05/rent.csv&#39;)</code></pre>
<p>What are the variable types? Do they all correspond to what they really are? Which variables have most missing values?</p>
<p>This dataset has 2 different types of data sets - character and double. All the variables correspond to the respective data types. The character data type is used for all text based variables like city, country, etc and the double precision data type is used for numeric and date variables. ‘descr’ has the most missing value, 197542. ‘adress’ has the second most missing value, of 196888.</p>
<pre class="r"><code>skimr::skim(rent)</code></pre>
<table>
<caption>(#tab:skim_data)Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">rent</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">200796</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">17</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">8</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<colgroup>
<col width="18%" />
<col width="13%" />
<col width="18%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="12%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">post_id</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">200796</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">nhood</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">43</td>
<td align="right">0</td>
<td align="right">167</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">city</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">5</td>
<td align="right">19</td>
<td align="right">0</td>
<td align="right">104</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">county</td>
<td align="right">1394</td>
<td align="right">0.99</td>
<td align="right">4</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">address</td>
<td align="right">196888</td>
<td align="right">0.02</td>
<td align="right">1</td>
<td align="right">38</td>
<td align="right">0</td>
<td align="right">2869</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">title</td>
<td align="right">2517</td>
<td align="right">0.99</td>
<td align="right">2</td>
<td align="right">298</td>
<td align="right">0</td>
<td align="right">184961</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">descr</td>
<td align="right">197542</td>
<td align="right">0.02</td>
<td align="right">13</td>
<td align="right">16975</td>
<td align="right">0</td>
<td align="right">3025</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">details</td>
<td align="right">192780</td>
<td align="right">0.04</td>
<td align="right">4</td>
<td align="right">595</td>
<td align="right">0</td>
<td align="right">7667</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="12%" />
<col width="8%" />
<col width="12%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.01e+07</td>
<td align="right">44694.07</td>
<td align="right">2.00e+07</td>
<td align="right">2.01e+07</td>
<td align="right">2.01e+07</td>
<td align="right">2.01e+07</td>
<td align="right">2.02e+07</td>
<td align="left">▁▇▁▆▃</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.01e+03</td>
<td align="right">4.48</td>
<td align="right">2.00e+03</td>
<td align="right">2.00e+03</td>
<td align="right">2.01e+03</td>
<td align="right">2.01e+03</td>
<td align="right">2.02e+03</td>
<td align="left">▁▇▁▆▃</td>
</tr>
<tr class="odd">
<td align="left">price</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.14e+03</td>
<td align="right">1427.75</td>
<td align="right">2.20e+02</td>
<td align="right">1.30e+03</td>
<td align="right">1.80e+03</td>
<td align="right">2.50e+03</td>
<td align="right">4.00e+04</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">beds</td>
<td align="right">6608</td>
<td align="right">0.97</td>
<td align="right">1.89e+00</td>
<td align="right">1.08</td>
<td align="right">0.00e+00</td>
<td align="right">1.00e+00</td>
<td align="right">2.00e+00</td>
<td align="right">3.00e+00</td>
<td align="right">1.20e+01</td>
<td align="left">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">baths</td>
<td align="right">158121</td>
<td align="right">0.21</td>
<td align="right">1.68e+00</td>
<td align="right">0.69</td>
<td align="right">1.00e+00</td>
<td align="right">1.00e+00</td>
<td align="right">2.00e+00</td>
<td align="right">2.00e+00</td>
<td align="right">8.00e+00</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">sqft</td>
<td align="right">136117</td>
<td align="right">0.32</td>
<td align="right">1.20e+03</td>
<td align="right">5000.22</td>
<td align="right">8.00e+01</td>
<td align="right">7.50e+02</td>
<td align="right">1.00e+03</td>
<td align="right">1.36e+03</td>
<td align="right">9.00e+05</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">room_in_apt</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.00e+00</td>
<td align="right">0.04</td>
<td align="right">0.00e+00</td>
<td align="right">0.00e+00</td>
<td align="right">0.00e+00</td>
<td align="right">0.00e+00</td>
<td align="right">1.00e+00</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">lat</td>
<td align="right">193145</td>
<td align="right">0.04</td>
<td align="right">3.77e+01</td>
<td align="right">0.35</td>
<td align="right">3.36e+01</td>
<td align="right">3.74e+01</td>
<td align="right">3.78e+01</td>
<td align="right">3.78e+01</td>
<td align="right">4.04e+01</td>
<td align="left">▁▁▅▇▁</td>
</tr>
<tr class="odd">
<td align="left">lon</td>
<td align="right">196484</td>
<td align="right">0.02</td>
<td align="right">-1.22e+02</td>
<td align="right">0.78</td>
<td align="right">-1.23e+02</td>
<td align="right">-1.22e+02</td>
<td align="right">-1.22e+02</td>
<td align="right">-1.22e+02</td>
<td align="right">-7.42e+01</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code>spec(rent)</code></pre>
<pre><code>## cols(
##   post_id = col_character(),
##   date = col_double(),
##   year = col_double(),
##   nhood = col_character(),
##   city = col_character(),
##   county = col_character(),
##   price = col_double(),
##   beds = col_double(),
##   baths = col_double(),
##   sqft = col_double(),
##   room_in_apt = col_double(),
##   address = col_character(),
##   lat = col_double(),
##   lon = col_double(),
##   title = col_character(),
##   descr = col_character(),
##   details = col_character()
## )</code></pre>
<pre class="r"><code>unique(rent$city)</code></pre>
<pre><code>##   [1] &quot;alameda&quot;             &quot;san francisco&quot;       &quot;el cerrito&quot;         
##   [4] &quot;san jose&quot;            &quot;american canyon&quot;     &quot;atherton&quot;           
##   [7] &quot;belmont&quot;             &quot;ben lomond&quot;          &quot;berkeley&quot;           
##  [10] &quot;boulder cr&quot;          &quot;brentwood&quot;           &quot;brisbane&quot;           
##  [13] &quot;brookdale&quot;           &quot;burlingame&quot;          &quot;calistoga&quot;          
##  [16] &quot;campbell&quot;            &quot;soquel&quot;              &quot;cazadero&quot;           
##  [19] &quot;clayton&quot;             &quot;cloverdale&quot;          &quot;pescadero&quot;          
##  [22] &quot;colma&quot;               &quot;concord&quot;             &quot;corralitos&quot;         
##  [25] &quot;corte madera&quot;        &quot;crockett&quot;            &quot;cupertino&quot;          
##  [28] &quot;daly city&quot;           &quot;san ramon&quot;           &quot;dillon beach&quot;       
##  [31] &quot;winters&quot;             &quot;dublin&quot;              &quot;east bay&quot;           
##  [34] &quot;emeryville&quot;          &quot;fairfax&quot;             &quot;fairfield&quot;          
##  [37] &quot;felton&quot;              &quot;forest knolls&quot;       &quot;foster city&quot;        
##  [40] &quot;geyserville&quot;         &quot;gilroy&quot;              &quot;cordelia&quot;           
##  [43] &quot;greenbrae&quot;           &quot;guerneville&quot;         &quot;half moon bay&quot;      
##  [46] &quot;hayward&quot;             &quot;healdsburg&quot;          &quot;el sobrante&quot;        
##  [49] &quot;inverness&quot;           &quot;kentfield&quot;           &quot;orinda&quot;             
##  [52] &quot;woodacre&quot;            &quot;larkspur&quot;            &quot;livermore&quot;          
##  [55] &quot;los altos&quot;           &quot;los gatos&quot;           &quot;marin&quot;              
##  [58] &quot;menlo park&quot;          &quot;mill valley&quot;         &quot;millbrae&quot;           
##  [61] &quot;milpitas&quot;            &quot;montara&quot;             &quot;morgan hill&quot;        
##  [64] &quot;mountain view&quot;       &quot;napa county&quot;         &quot;north bay&quot;          
##  [67] &quot;novato&quot;              &quot;oakland&quot;             &quot;pacifica&quot;           
##  [70] &quot;palo alto&quot;           &quot;peninsula&quot;           &quot;petaluma&quot;           
##  [73] &quot;pittsburg&quot;           &quot;redwood city&quot;        &quot;redwood shores&quot;     
##  [76] &quot;richmond&quot;            &quot;rio vista&quot;           &quot;rohnert park&quot;       
##  [79] &quot;russian river&quot;       &quot;san anselmo&quot;         &quot;san bruno&quot;          
##  [82] &quot;san leandro&quot;         &quot;san mateo&quot;           &quot;san rafael&quot;         
##  [85] &quot;santa clara&quot;         &quot;santa cruz&quot;          &quot;santa rosa&quot;         
##  [88] &quot;saratoga&quot;            &quot;sausalito&quot;           &quot;scotts valley&quot;      
##  [91] &quot;sebastopol&quot;          &quot;sf bay area&quot;         &quot;sonoma&quot;             
##  [94] &quot;south bay&quot;           &quot;south san francisco&quot; &quot;sunnyvale&quot;          
##  [97] &quot;belvedere&quot;           &quot;union city&quot;          &quot;vallejo&quot;            
## [100] &quot;walnut creek&quot;        &quot;watsonville&quot;         &quot;cambrian&quot;           
## [103] &quot;woodside&quot;            &quot;yountville&quot;</code></pre>
<p>Make a plot that shows the top 20 cities in terms of % of classifieds between 2000-2018. You need to calculate the number of listings by city, and then convert that number to a %.</p>
<pre class="r"><code>rent %&gt;%
  count(city, sort=TRUE) %&gt;% 
  mutate(prop = n/sum(n)) %&gt;% 
  slice_max(n= 20, order_by= prop) %&gt;% 
  mutate(city = fct_reorder(city,prop)) %&gt;% 
  ggplot(aes(x= prop, y= city))+
  geom_col()+
  theme_minimal(base_size = 18)+
  scale_x_continuous(labels = scales::percent)+labs (x = &#39;prop&#39;, y = &#39;city&#39;, caption = &quot;Source: Kate(2018). Bay Area Craiglist Rental Housing Posts, 2000 - 2018&quot;)</code></pre>
<p><img src="/blogs/blog2_files/figure-html/top_cities-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Make a plot that shows the evolution of median prices in San Francisco for 0, 1, 2, and 3 bedrooms listings.</p>
<pre class="r"><code>rent_sf&lt;- rent %&gt;%
          filter(city ==&quot;san francisco&quot;, beds &lt;= 3) %&gt;%
          group_by(year, beds) %&gt;%
          summarise(med_rn = median(price))
 
ggplot(rent_sf, aes(x=year, y=med_rn, color= factor(beds)))+geom_line()+facet_grid(~beds)</code></pre>
<p><img src="/blogs/blog2_files/figure-html/unnamed-chunk-2-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code>filtered_beds_0_2018 &lt;- rent %&gt;% group_by(beds,year) %&gt;% filter(city ==&#39;san francisco&#39;,beds == 0, year ==2018) 
head(filtered_beds_0_2018)</code></pre>
<pre><code>## # A tibble: 6 × 17
## # Groups:   beds, year [1]
##   post_id        date  year nhood   city  county price  beds baths  sqft room_…¹
##   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 6580981486 20180510  2018 castro  san … san f…  2250     0    NA    NA       0
## 2 6480252497 20180201  2018 CCSF    san … san f…  1800     0     1    NA       0
## 3 6584911622 20180510  2018 CCSF    san … san f…   900     0     1   150       0
## 4 6503872328 20180220  2018 civic … san … san f…   755     0    NA    NA       0
## 5 6499200906 20180301  2018 civic … san … san f…  1975     0    NA   300       0
## 6 6488645253 20180208  2018 civic … san … san f…  2395     0    NA   450       0
## # … with 6 more variables: address &lt;chr&gt;, lat &lt;dbl&gt;, lon &lt;dbl&gt;, title &lt;chr&gt;,
## #   descr &lt;chr&gt;, details &lt;chr&gt;, and abbreviated variable name ¹​room_in_apt</code></pre>
<p>Finally, make a plot that shows median rental prices for the top 2 cities in the Bay area. Your final graph should look like this</p>
<pre class="r"><code>top_twelve_data &lt;- rent %&gt;%
  count(city) %&gt;% #to count number of classifieds in each city
  arrange(desc(n)) %&gt;%
  slice(1:12) 
top_twelve_cities &lt;- as.vector(top_twelve_data$city)
top_twelve_cities</code></pre>
<pre><code>##  [1] &quot;san francisco&quot; &quot;san jose&quot;      &quot;oakland&quot;       &quot;santa rosa&quot;   
##  [5] &quot;santa cruz&quot;    &quot;san mateo&quot;     &quot;sunnyvale&quot;     &quot;mountain view&quot;
##  [9] &quot;berkeley&quot;      &quot;santa clara&quot;   &quot;palo alto&quot;     &quot;union city&quot;</code></pre>
<pre class="r"><code>rent %&gt;%
  filter(city %in% top_twelve_cities) %&gt;%
  group_by(year, city) %&gt;%
  summarize(median_price = median(price)) %&gt;%
ggplot(aes(year, median_price, color = factor(city))) +
  geom_line() +
  facet_wrap(vars(city)) +
  labs(
  title = &quot;Rental prices for 1-bedroom flats in the Bay Area&quot;,
  x = NULL,
  y = NULL,
  caption = &quot;Source: Pennington. Kate (2018). Bay Area Craigslist Rental Housing Posts 2000-2018&quot;) +
  theme(legend.position = &quot;None&quot;)</code></pre>
<p><img src="/blogs/blog2_files/figure-html/unnamed-chunk-4-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>The data set shows us that San Francisco has the maximum percentage listings, precisely 4x listings more than San Jose, the second highest listings city. This is valid since most listing are in the densely populated area of San Francisco rather than in the suburbs in the vicinity. Moreover, its vicinity to Silicon Valley makes it a hub for residences.</p>
<p>In San Francisco, the median prices see a major rise across all the types of bedroom (0-3 bedroom flats) across a 20 year period. The drop in rents from 2002 to 2006 was a result of the housing bubble that caused the demand to decrease and rent prices to plummet down. This bubble burst in 2008, post which we see a massive rise in rents (~90% rise in rent from 2010 to 2015). This similar trend was experienced across all the cities in the Bay Area, with a decline from 2002 to 2006, and a multifold rise in the years after that.</p>
</div>
